(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{v3:()=>z,Zw:()=>V,LS:()=>q,z4:()=>Z});class t{constructor(e){this.audio=new Audio(e)}play(){this.audio.volume=t.volume,this.audio.play()}isPlaying(){return!this.audio.paused&&!this.audio.ended}pause(){this.audio.pause()}stop(){this.audio.currentTime=0,this.audio.pause()}}t.volume=.2;class s{constructor(){this.canvas=document.createElement("canvas"),this.canvas.id="canvas"}static getInstance(){return s.instance||(s.instance=new s),s.instance}getCanvas(){return this.canvas}getCtx(){return this.ctx}getW(){return this.canvas.width}getH(){return this.canvas.height}start(e,t){return this.canvas.width=e,this.canvas.height=t,document.body.insertBefore(this.canvas,document.body.childNodes[2]),this.canvas}}const i={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},n={LEFT:0,MIDDLE:1,RIGHT:2};class a{constructor(){this.keyCode=i,this.mouseCode=n,this.keyBindings={keyDown:{},keyUp:{},keyPress:{}},this.mouseBindings=""}static getInstance(){return a.instance||(a.instance=new a),a.instance}start(){document.addEventListener("keydown",(e=>this.handleKeyDown(e))),document.addEventListener("keyup",(e=>this.handleKeyUp(e))),document.addEventListener("click",(e=>this.handleClick(e))),document.addEventListener("mousemove",(e=>this.handleMouseMove(e)))}handleKeyDown(e){this.keyCode[e.key]||(this.keyBindings.keyDown[e.key]=1,this.keyBindings.keyPress[e.key]=1),delete this.keyBindings.keyUp[e.key]}handleKeyUp(e){this.keyBindings.keyUp[e.key]=1,delete this.keyBindings.keyPress[e.key]}handleClick(e){e.button===this.mouseCode.LEFT?this.mouseBindings="LEFT":e.button===this.mouseCode.MIDDLE?this.mouseBindings="MIDDLE":e.button===this.mouseCode.RIGHT&&(this.mouseBindings="RIGHT")}handleMouseMove(e){const t=u.canvas.getCanvas().getBoundingClientRect(),s=e.clientX-t.x,i=e.clientY-t.y;this.mousePosition=[s,i]}getMousePosition(){return this.mousePosition}hasKeyDown(e){return 1==this.keyBindings.keyDown[e]}hasKeyUp(e){return 1==this.keyBindings.keyDown[e]}hasKeyPress(e){return 1==this.keyBindings.keyDown[e]}hasMouseBinding(e){return this.mouseBindings===e}removeMouseBinding(){this.mouseBindings=""}}class r{static draw(e,t,s,i,n){const a=new Path2D;a.arc(t,s,i,0,2*Math.PI,!1),e.fillStyle=n,e.fill(a),e.lineWidth=10,e.strokeStyle=n,e.stroke(a)}}class h{static draw(e,t,s,i,n,a,r){-1==r?h.drawMirrorImage(e,t,s,i,n,a):h.drawImage(e,t,s,i,n,a)}static drawImage(e,t,s,i,n,a){n&&a?e.drawImage(t,s,i,n,a):e.drawImage(t,s,i)}static drawMirrorImage(e,t,s,i,n,a){e.save(),e.translate(s,i),e.scale(-1,1),n&&a?e.drawImage(t,0,0,n,a,-45,0,n,a):e.drawImage(t,s,i),e.restore()}}class o{static draw(e,t,s,i,n,a){e.fillStyle=a,e.fillRect(t,s,i,n)}static isPointInRect(e,t,s,i,n,a){return Math.abs(e-s)<=n&&Math.abs(t-i)<=a}}class c{static draw(e,t,s,i,n,a=70){e.fillStyle=n,e.font=a?"bold "+a+"px Arial":"bold 70px Arial",t.length<2?e.fillText(t,s,i):t.length<3?e.fillText(t,s-20,i):e.fillText(t,s-40,i)}}class g{constructor(e){this.canvas=e,this.depth=[],this.ctx=e.getContext("2d")}static getInstance(e){return g.instance||(g.instance=new g(e)),g.instance}setDepth(e){this.depth.push(e)}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}draw(){this.depth[0].draw(),this.depth.pop()}drawRect(e,t,s,i,n){o.draw(this.ctx,e,t,s,i,n)}drawCircle(e,t,s,i){r.draw(this.ctx,e,t,s,i)}drawText(e,t,s,i,n=70){c.draw(this.ctx,e,t,s,i,n)}drawImage(e,t,s,i,n){h.draw(this.ctx,e,t,s,i,n,1)}drawMirrorLRImage(e,t,s,i,n){h.draw(this.ctx,e,t,s,i,n,-1)}}class d{constructor(){}static getInstance(){return d.instance||(d.instance=new d),d.instance}getCurrentScene(){return this.currentScene}loadScene(e){this.currentScene&&this.currentScene.unload(),this.currentScene=e,this.currentScene.load(),u.renderer.setDepth(this.currentScene),u.renderer.draw()}}class l{constructor(){if(this.components=[],null!=l.instance)return l.instance;this.state=2,this.canvas=s.getInstance(),this.inputManager=a.getInstance(),this.sceneManager=d.getInstance(),this.renderer=g.getInstance(this.canvas.getCanvas()),l.instance=this}static getInstance(){return null==l.instance&&(l.instance=new l),l.instance}start(e,t,s){this.canvas.start(e,t),this.inputManager.start(),this.sceneManager.loadScene(s)}draw(){this.clearCanvas(this.canvas.getCanvas());for(const e of this.components)e.getIsEnabled()&&e.draw()}update(e){switch(this.state){case 0:for(const t of this.components)t.getIsEnabled()&&t.update(e);break;case 1:for(const t of this.components)t.getIsEnabled()&&t.pause(e)}}clearCanvas(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}addComponent(e){this.components.push(e)}pause(){this.state=1}over(){this.state=3}resume(){this.state=0}}const u=l.getInstance();class p{constructor(e){this.canvas=e,this.context=e.getContext("2d")}getObjects(){return this.objects}}class m{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}setX(e){this.x=e}setY(e){this.y=e}static add(e,t){return new m(e.x+t.x,e.y+t.y)}static sub(e,t){return new m(e.x-t.x,e.y-t.y)}static mul(e,t){return new m(e.x*t,e.y*t)}static distance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}}s.getInstance().start(360,480).getContext("2d");class w{constructor(){this.isEnabled=!0,this.isActive=!0,this.game=u,this.canvas=u.canvas.getCanvas()}getIsEnabled(){return this.isEnabled}setToggleActive(e){e&&!this.isEnabled?(this.isEnabled=!0,this.onEnable()):!e&&this.isEnabled&&(this.isEnabled=!1,this.onDisable())}pauseGame(){this.game.pause()}resumeGame(){this.game.resume()}reset(){}onEnable(){}onDisable(){}}class S extends w{onCollision(e){throw new Error("Method not implemented.")}constructor(e=new m(0,0)){super(),this.components={},this.position=e,this.game=u}getW(){return this.w}getH(){return this.h}setW(e){this.w=e}setH(e){this.h=e}getX(){return this.getPosition().getX()}getY(){return this.getPosition().getY()}setX(e){this.setPosition(new m(e,this.getY()))}setY(e){this.setPosition(new m(this.getX(),e))}setToggleActive(e){if(e&&!this.isEnabled){for(const e in this.components)this.components[e].setToggleActive(!0);this.isEnabled=!0,this.onEnable()}else if(!e&&this.isEnabled){for(const e in this.components)this.components[e].setToggleActive(!0);this.isEnabled=!1,this.onDisable()}}setPosition(e){this.position=e}getPosition(){return this.position}addComponent(e){this.components[e.getName()]=e}getComponent(e){return this.components[e]}}class y extends w{constructor(e){super(),this.game.addComponent(this),this.gameObject=e,this.gameObject.addComponent(this)}getName(){return this.name}setName(e){this.name=e}}class b extends y{constructor(e){super(e)}setSpriteImg(e){this.image=e}getSpriteImg(){return this.image}draw(){this.gameObject.getIsEnabled()&&this.gameObject.draw()}update(e){}pause(e){}}const k=new Image;k.src="assets/images/background.png";class v extends S{constructor(e){super(e),this.setW(320),this.setH(480),this.setX(180),this.setY(235),this.sprite=new b(this),this.sprite.setSpriteImg(k)}draw(){this.game.renderer.drawImage(k,this.getX()-this.getW()/2,this.getY()-this.getH()/2,this.getW(),this.getH())}update(e,t){}pause(){}}const I=new Image;I.src="assets/images/spikes_small_up.png";class C extends S{constructor(e){super(e),this.setW(1080/3.3-7),this.setH(218/3.3),this.setX(20),this.setY(425),this.sprite=new b(this),this.sprite.setSpriteImg(I)}draw(){u.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH())}update(e,t){}pause(){}onCollision(e){}}const M=new Image;M.src="assets/images/spikes_small.png";class f extends S{constructor(e){super(e),this.setW(1080/3.3-7),this.setH(218/3.3),this.setX(20),this.setY(0),this.sprite=new b(this),this.sprite.setSpriteImg(M)}draw(){u.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH())}update(e,t){}pause(){}onCollision(e){}}(new Image).src="assets/images/background.png";const x=new Image;x.src="assets/images/points.png";const E=new Image;E.src="assets/images/dttsString.png";const X=new Image;X.src="assets/images/StringBEST.png";const P=new Image;P.src="assets/images/HitString.png";class Y extends S{constructor(e){super(e),this.bestScore=0,this.gamesPlayed=0,this.candyCount=0,this.score=0,this.setX(180),this.setY(240),this.sprite=new b(this)}drawStartScore(){const e=this.game.renderer;e.drawImage(E,45,75,873/3.2,75),e.drawImage(P,125,170,111,57),e.drawImage(X,70,327,191.875,48.4375),e.drawText(K.getScore().bestScore.toString(),267,350,"#ababab",30),e.drawText(K.getScore().gamesPlayed.toString(),267,377,"#ababab",30)}drawEndScore(){const e=this.game.renderer;e.drawImage(E,45,75,873/3.2,75),e.drawImage(x,45,180,230/.85,150);const t=K.getScore().score+3*this.candyCount;t<10?e.drawText(K.getScore().score.toString(),163,235,"white",50):t>=10&&t<100?e.drawText(K.getScore().score.toString(),170,235,"white",50):t>=100&&e.drawText(K.getScore().score.toString(),163,235,"white",50),e.drawImage(X,74,350,191.875,48.4375),e.drawText(K.getScore().bestScore.toString(),287,370,"#aaa",30),e.drawText(K.getScore().gamesPlayed.toString(),287,397,"#aaa",30)}drawGameScore(){const e=this.game.renderer;e.drawCircle(this.getX(),this.getY(),65,"white"),this.score<10||this.score<100?e.drawText(this.score.toString(),160,268,"#ababab"):this.score>=100&&e.drawText(this.score.toString(),150,268,"#ababab")}draw(){2===this.game.state?this.drawStartScore():0===this.game.state?this.drawGameScore():this.drawEndScore()}update(e,t){}pause(){}increaseScore(){this.score+=1}getScore(){return this.score}updateCandy(){this.candyCount++}getCandy(){return this.candyCount}getBestScore(){return this.bestScore}getGamesPlayed(){return this.gamesPlayed}}class T extends p{constructor(e){super(e)}getScore(){return this.score}load(){this.background=new v(new m(0,0)),this.score=new Y(new m(0,0)),this.topSpikes=new f(new m(0,0)),this.botSpikes=new C(new m(0,0))}draw(){if(u.inputManager.hasMouseBinding("LEFT")){const[e,t]=u.inputManager.getMousePosition();o.isPointInRect(e,t,50,277,262,53)&&(u.state=2)}u.inputManager.removeMouseBinding()}update(){}unload(){u.renderer.clear()}}class D extends y{constructor(e){super(e),this.gravity=.2,this.bounceRate=3.5,this.force=new m(.01,0),this.velocity=new m(2.5,0)}update(e){this.velocity=m.add(this.velocity,m.mul(new m(this.force.getX(),this.force.getY()+this.gravity),e/16)),this.gameObject.setPosition(m.add(this.gameObject.getPosition(),m.mul(this.velocity,e/16)))}jump(){this.velocity.setY(-this.bounceRate)}changeDirection(){this.velocity=m.mul(this.velocity,-1),this.velocity.setY(-1)}draw(){}pause(){}}class H extends y{constructor(e){super(e),this.checkOutOfBounds=()=>this.gameObject.getY()<Math.floor(this.gameObject.getH())+40||this.gameObject.getY()>480-Math.floor(this.gameObject.getH())-70,this.checkHitRectangle=e=>{const[t,s]=[this.gameObject.getX(),this.gameObject.getY()],[i,n,a,r]=[e.getX(),e.getY(),e.getW(),e.getH()];return Math.abs(i-t)<=a&&Math.abs(n-s)<=r}}draw(){}update(){}pause(){}checkWallCollision(e){return 2==e&&Math.floor(this.gameObject.getX())>=360-Math.floor(this.gameObject.getW())-20||1==e&&Math.floor(this.gameObject.getX())<=20}checkHitTriangle(e,t){const[s,i,n]=t,a=(i.getY()-n.getY())*(s.getX()-n.getX())+(n.getX()-i.getX())*(s.getY()-n.getY()),r=((i.getY()-n.getY())*(e.getX()-n.getX())+(n.getX()-i.getX())*(e.getY()-n.getY()))/a,h=((n.getY()-s.getY())*(e.getX()-n.getX())+(s.getX()-n.getX())*(e.getY()-n.getY()))/a;return r>=0&&h>=0&&1-r-h>=0}}class B extends y{constructor(e){super(e),this.freq=980,this.amplitude=.5,this.phase=0,this.velocity=new m(0,this.amplitude)}update(e){this.phase+=2*Math.PI*this.freq*e/16,this.velocity.setY(this.amplitude*Math.sin(this.phase)*e/16),this.gameObject.setPosition(m.add(this.gameObject.getPosition(),m.mul(this.velocity,e/16)))}draw(){}pause(){}}class A{constructor(){this.subscribers=new Set}subscribe(e){this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}notify(e){for(const t of this.subscribers)t.onCollision(e)}}const O=new Image;O.src="assets/images/bird1_small.png";const W=new Image;W.src="assets/images/bird2_small.png";class R extends S{constructor(e,t){super(t),this.checkCandyCollided=!1,this.flap=()=>{q.play(),this.sprite.setSpriteImg(O),this.physics.jump()},this.checkHitSpike=e=>{const[t,s,i,n]=[this.getX(),this.getY(),this.getW(),this.getH()],[a,r]=[69/3.2,36.25];let h,o,c;if(2==this.direction){if(h=new m(357-a,e),o=new m(357-2*a,e+r/2),c=new m(357-a,e+r),this.collider.checkHitTriangle(new m(t+this.getW(),s),[h,o,c])||this.collider.checkHitTriangle(new m(t+i,s+n),[h,o,c])||this.collider.checkHitTriangle(new m(t+i,(s+s+n)/2),[h,o,c]))return!0}else if(h=new m(0+a,e),o=new m(0+a,e+r),c=new m(0+2*a,e+r/2),this.collider.checkHitTriangle(new m(t,s),[h,o,c])||this.collider.checkHitTriangle(new m(t,s+n),[h,o,c])||this.collider.checkHitTriangle(new m(t,(s+s+n)/2),[h,o,c]))return!0;return!1},this.setW(48.75),this.setH(31.5625),this.setX(160),this.setY(240),this.eventSystem=new A,this.name=e,this.direction=2,this.sprite=new b(this),this.sprite.setSpriteImg(W),this.oscillator=new B(this),this.physics=new D(this),this.collider=new H(this)}subscribeCollision(){const e=K.game.sceneManager.getCurrentScene();this.eventSystem.subscribe(e.getBird()),this.eventSystem.subscribe(e.getCandy());for(const t of e.getSpikes())this.eventSystem.subscribe(t)}draw(){if("Game"==this.name){const e=K.game.sceneManager.getCurrentScene();this.collider.checkOutOfBounds()&&this.eventSystem.notify(2),this.collider.checkHitRectangle(e.getCandy())&&e.getCandy().getIsEnabled()&&this.eventSystem.notify(3);for(const t of e.getSpikes())this.checkHitSpike(t.getY())&&this.eventSystem.notify(1)}this.handleChangeDirection(),this.sprite.setSpriteImg(W)}handleChangeDirection(){2==this.direction?(K.game.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH()),this.collider.checkWallCollision(this.direction)&&"Game"==this.name&&(this.direction=1,this.eventSystem.notify(0))):1==this.direction&&(K.game.renderer.drawMirrorLRImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH()),this.collider.checkWallCollision(this.direction)&&"Game"==this.name&&(this.direction=2,this.eventSystem.notify(0)))}enableCandy(){if("Game"==this.name){const e=K.game.sceneManager.getCurrentScene();e.getCandy().getIsEnabled()||e.getCandy().setToggleActive(!0)}}onCollision(e){2==e?(V.play(),K.game.over()):0==e&&(Z.play(),this.physics.changeDirection(),K.updateWallCollision(),this.enableCandy())}}const j=new Image;j.src="assets/images/candy.png";class L extends S{constructor(e){super(e),this.setW(36.875),this.setH(21.875),this.setX(70),this.setY(-70),this.sprite=new b(this),this.sprite.setSpriteImg(j),this.oscillator=new B(this)}draw(){u.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH())}update(e){this.setY(e.getY()-20),e.getX()>300?this.setX(e.getX()-40):this.setX(e.getX()+45)}pause(){}onCollision(e){if(3==e){const e=K.game.sceneManager.getCurrentScene();z.play(),e.getScore().updateCandy(),e.getCandy().setToggleActive(!1)}}}const G=new Image;G.src="assets/images/spike_small.png";class U extends S{constructor(e){super(e),this.setW(69/3.2),this.setH(36.25),this.setX(318),this.setY(-70),this.physics=new B(this),this.sprite=new b(this),this.sprite.setSpriteImg(G)}draw(){this.getX()>300?u.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH()):u.renderer.drawMirrorLRImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH())}update(e){}pause(){}onCollision(e){1==e&&(V.play(),K.game.over())}}class N extends S{constructor(){super(),this.reset=()=>{this.length=3,this.spikes=[];for(let e=0;e<this.length;e++)this.spikes.push(new U(new m(0,0)))},this.length=3,this.spikes=[];for(let e=0;e<this.length;e++)this.spikes.push(new U(new m(0,0)));this.sprite=new b(this)}genRandom(){let e=0,t=0;for(;0===e;)e=Math.random();for(;0===t;)t=Math.random();let s=Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t);return s=s/10+.5,s>1||s<0?this.genRandom():s}getSpikes(){return this.spikes}draw(){for(let e=0;e<this.length;e++)this.spikes[e].draw()}update(){K.getScore().score>0&&K.getScore().score%5==0&&(console.log(1111),this.spikes.push(new U(new m(0,0))),this.length++);const e=290/this.length;for(let t=0;t<this.length;t++){const s=Math.floor(this.genRandom()*e+80+e*t);s>=90&&s<380&&(this.spikes[t].setY(s),this.spikes[t].getX()>300?this.spikes[t].setX(-3):this.spikes[t].setX(318))}}}class _ extends p{constructor(e){super(e)}getScore(){return this.score}load(){this.background=new v(new m(0,0)),this.score=new Y(new m(0,0)),this.bird=new R("Game",new m(0,0)),this.topSpikes=new f(new m(0,0)),this.botSpikes=new C(new m(0,0)),this.sideSpikes=new N,this.candy=new L(new m(0,0)),this.bird.subscribeCollision()}getBird(){return this.bird}getCandy(){return this.candy}getSpikes(){return this.sideSpikes.getSpikes()}draw(){u.inputManager.hasMouseBinding("LEFT")&&this.bird.flap(),u.inputManager.removeMouseBinding()}update(){this.getScore().increaseScore(),K.getScore().score=this.getScore().getScore(),this.sideSpikes.update(),this.candy.update(this.sideSpikes.getSpikes().slice(-1)[0])}unload(){K.getScore().score=this.getScore().getScore()+3*this.getScore().getCandy(),K.getScore().bestScore=Math.max(K.getScore().bestScore,K.getScore().score),K.getScore().gamesPlayed++,this.bird.setToggleActive(!1),u.renderer.clear()}}class F extends p{constructor(e){super(e)}getScore(){return this.score}load(){this.background=new v(new m(0,0)),this.score=new Y(new m(0,0)),this.bird=new R("Ready",new m(0,0)),this.topSpikes=new f(new m(0,0)),this.botSpikes=new C(new m(0,0))}draw(){u.inputManager.hasMouseBinding("LEFT")&&(u.state=0),u.inputManager.removeMouseBinding()}update(){}unload(){this.bird.setToggleActive(!1),u.renderer.clear()}}const K=new class{constructor(){this.game=u,this.score={score:0,bestScore:0,gamesPlayed:0},this.curState=2}getScore(){return this.score}updateWallCollision(){u.sceneManager.getCurrentScene().update()}start(){u.start(360,480,new F(u.canvas.getCanvas()))}draw(){if(u.draw(),this.curState!=u.state)switch(this.curState=u.state,u.state){case 2:this.game.sceneManager.loadScene(new F(u.canvas.getCanvas()));break;case 0:this.game.sceneManager.loadScene(new _(u.canvas.getCanvas()));break;case 3:this.game.sceneManager.loadScene(new T(u.canvas.getCanvas()))}u.sceneManager.getCurrentScene().draw()}update(e){u.update(e)}},q=new t("assets/sounds/jump.ogg"),z=new t("assets/sounds/candy.mp3"),V=new t("assets/sounds/death.ogg"),Z=new t("assets/sounds/point.ogg");K.start(),function e(t){const s=Date.now();K.draw(),K.update(s-t),t=Date.now(),requestAnimationFrame((()=>e(t)))}(Date.now())})();