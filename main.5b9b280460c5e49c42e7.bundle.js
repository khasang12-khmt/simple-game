(()=>{"use strict";var t={d:(i,s)=>{for(var e in s)t.o(s,e)&&!t.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:s[e]})},o:(t,i)=>Object.prototype.hasOwnProperty.call(t,i)};t.d({},{H:()=>w});const i=document.getElementById("game"),s=i.getContext("2d"),e=new Image;e.src="assets/images/bird1.png";const h=new Image;h.src="assets/images/bird2.png";class r{constructor(){this.w=156,this.h=101,this.x=140,this.y=240,this.score=0,this.bestScore=0,this.gamesPlayed=0,this.speed=0,this.jump=3,this.gravity=.15,this.vx=2,this.image=h,this.direction=2,this.checkWallCollision=()=>{2==this.direction&&Math.floor(this.x)>=320-Math.floor(this.w/3.2)&&(this.direction=1,this.score++,w.spike.update(),this.score>0&&this.score%5==0&&w.spike.length++),1==this.direction&&Math.floor(this.x)<=0&&(this.direction=2,this.score++,w.spike.update())},this.checkOutOfBounds=()=>{(this.y<Math.floor(this.w/3.2)||this.y>480-Math.floor(this.w/3.2)-50)&&this.gameOver()},this.drawBoundBox=t=>{s.fillStyle="red",s.fillRect(0,t+12,4,-4),s.fillRect(0,t+w.spike.h/2-18,4,4),s.fillRect(0+w.spike.w/3-2,t+w.spike.h/8+18,4,-4),s.fillRect(317,t+w.spike.h/2-18,4,-4),s.fillRect(317,t+12,4,4),s.fillRect(317-w.spike.w/3.2,t+w.spike.h/8+18,4,-4),s.fillStyle="green",s.fillRect(w.bird.x+this.w/3.2,w.bird.y,4,4),s.fillRect(w.bird.x+this.w/3.2,w.bird.y+this.h/3.1,4,-4),s.fillRect(w.bird.x+this.w/3.2,(w.bird.y+w.bird.y+this.h/3.1)/2,4,-4),s.fillRect(w.bird.x,w.bird.y,4,-4),s.fillRect(w.bird.x,w.bird.y+this.h/3.1,4,4),s.fillRect(w.bird.x,(w.bird.y+w.bird.y+this.h/3.1)/2,4,4)},this.checkInsideTriangle=(t,i)=>{const[s,e,h]=i,r=(e[1]-h[1])*(s[0]-h[0])+(h[0]-e[0])*(s[1]-h[1]),a=((e[1]-h[1])*(t[0]-h[0])+(h[0]-e[0])*(t[1]-h[1]))/r,o=((h[1]-s[1])*(t[0]-h[0])+(s[0]-h[0])*(t[1]-h[1]))/r;return a>=0&&o>=0&&1-a-o>=0},this.checkHitSpike=t=>{let i,s,e,h,r,a;2==this.direction?(i=317,h=t+12,s=317,r=t+w.spike.h/2-18,e=317-w.spike.w/3.2,a=t+w.spike.h/8+18,(this.checkInsideTriangle([w.bird.x+this.w/3.2,w.bird.y],[[i,h],[s,r],[e,a]])||this.checkInsideTriangle([w.bird.x+this.w/3.2,w.bird.y+this.h/3.1],[[i,h],[s,r],[e,a]])||this.checkInsideTriangle([w.bird.x+this.w/3.2,(w.bird.y+w.bird.y+this.h/3.1)/2],[[i,h],[s,r],[e,a]]))&&this.gameOver()):(i=0,h=t+12,s=0,r=t+w.spike.h/2-18,e=0+w.spike.w/3-2,a=t+w.spike.h/8+18,(this.checkInsideTriangle([w.bird.x,w.bird.y],[[i,h],[s,r],[e,a]])||this.checkInsideTriangle([w.bird.x,w.bird.y+this.h/3.1],[[i,h],[s,r],[e,a]])||this.checkInsideTriangle([w.bird.x,(w.bird.y+w.bird.y+this.h/3.1)/2],[[i,h],[s,r],[e,a]]))&&this.gameOver())},this.gameOver=()=>{w.states.current=w.states.OVER,this.bestScore=Math.max(this.score,this.bestScore),this.gamesPlayed++,this.reset()},this.draw=()=>{2==this.direction?s.drawImage(this.image,0,0,this.w,this.h,this.x,this.y,this.w/3.2,this.h/3.2):1==this.direction&&(s.save(),s.translate(this.x,this.y),s.scale(-1,1),s.drawImage(this.image,0,0,this.w,this.h,-45,0,this.w/3.2,this.h/3.2),s.restore())},this.update=()=>{if(w.states.current!=w.states.GAME)this.y+=.1,Math.abs(this.y-240)>=10&&(this.y=240);else{this.speed-=this.gravity,this.y-=this.speed,this.speed<=0&&(this.image=e),this.x+=2==this.direction?this.vx:-this.vx,this.checkWallCollision(),this.checkOutOfBounds();for(const t of w.spike.positions)this.drawBoundBox(t),this.checkHitSpike(t)}},this.flap=()=>{this.speed=this.jump},this.reset=()=>{this.x=140,this.y=190,this.speed=0,this.direction=2}}}const a=new Image;a.src="assets/images/spike.png";class o{constructor(){this.w=69,this.h=116,this.length=3,this.positions=new Array(length).fill(0),this.update=()=>{this.positions=[];for(let t=0;t<this.length;t++){let i=Math.floor(320*Math.random())+60;t>0&&Math.sqrt(Math.pow(this.positions[t-1],2)-Math.pow(i,2))<this.h/2&&(i=this.positions[t-1]+this.h/2),this.positions.push(i)}},this.draw=()=>{for(let t=0;t<this.length;t++){const i=this.positions[t];2==w.bird.direction?s.drawImage(a,0,0,this.w,this.h,298,i,this.w/2,this.h/2):1==w.bird.direction&&(s.save(),s.translate(0,i),s.scale(-1,1),s.drawImage(a,0,0,this.w,this.h,-22,0,this.w/2,this.h/2),s.restore())}},this.reset=()=>{this.positions=[],this.length=3}}}const l=new Image;l.src="assets/images/spikes.png";class d{constructor(){this.w=1080,this.h=218,this.topX=0,this.topY=0,this.botX=337.5,this.botY=480,this.draw=()=>{s.drawImage(l,0,0,this.w,this.h,this.topX,this.topY,this.w/3.2,this.h/3.2),s.save(),s.translate(0,0),s.rotate(180*Math.PI/180),s.drawImage(l,0,0,this.w,this.h,-this.botX,-this.botY,this.w/3.2,this.h/3.2),s.restore()}}}const n=new Image;n.src="assets/images/points.png";const c=new Image;c.src="assets/images/dttsString.png";const b=new Image;b.src="assets/images/StringBEST.png";const g=new Image;g.src="assets/images/HitString.png";const w=new class{constructor(){this.spikes=new d,this.spike=new o,this.bird=new r,this.states={current:1,READY:1,GAME:2,OVER:3}}drawStart(){this.states.current==this.states.READY&&(this.spikes.draw(),this.bird.draw(),s.fillStyle="#aaa",s.font="bold 30px Arial",s.drawImage(c,0,0,873,240,30,70,873/3.2,75),s.drawImage(b,0,0,614,155,60,330,191.875,48.4375),s.drawImage(g,0,0,111,57,105,170,111,57),s.fillText(this.bird.bestScore.toString(),267,350),s.fillText(this.bird.gamesPlayed.toString(),267,377))}drawGame(){if(this.states.current==this.states.GAME){this.spike.draw();const t=new Path2D;t.arc(160,220,65,0,2*Math.PI,!1),s.fillStyle="white",s.fill(t),s.lineWidth=10,s.strokeStyle="white",s.stroke(t),s.fillStyle="#ebebeb",s.font="bold 70px Arial",this.bird.score<10?s.fillText(this.bird.score.toString(),142,240):this.bird.score>=10&&this.bird.score<100?s.fillText(this.bird.score.toString(),122,240):this.bird.score>=100&&s.fillText(this.bird.score.toString(),105,240),this.bird.draw()}}drawEnd(){this.states.current==this.states.OVER&&(this.spikes.draw(),this.bird.draw(),s.fillStyle="#aaa",s.font="bold 30px Arial",s.drawImage(c,0,0,873,240,30,70,873/3.2,75),s.drawImage(b,0,0,614,155,60,330,191.875,48.4375),s.drawImage(n,0,0,900,800,65,180,220,180),s.fillStyle="#ebebeb",this.bird.score<10?s.fillText(this.bird.score.toString(),155,210):this.bird.score>=10&&this.bird.score<100?s.fillText(this.bird.score.toString(),150,210):this.bird.score>=100&&s.fillText(this.bird.score.toString(),145,210),s.fillStyle="#aaa",s.fillText(this.bird.bestScore.toString(),267,350),s.fillText(this.bird.gamesPlayed.toString(),267,377))}updateGameState(t){if(this.states.current==this.states.READY)this.bird.score=0,this.states.current=this.states.GAME;else if(this.states.current==this.states.GAME)this.bird.flap();else{this.bird.reset(),this.spike.reset();const e=i.getBoundingClientRect(),h=t.clientX-e.left,r=t.clientY-e.top,a=new Path2D;a.rect(70,245,200,30),a.closePath(),s.fillStyle="#FFFFFF",s.fillStyle="rgba(225,225,225,0.5)",s.fill(a),s.isPointInPath(a,h,r)&&(this.states.current=this.states.READY)}}draw(){s.fillStyle="#ebebeb",s.fillRect(0,0,320,480),this.spikes.draw(),this.drawStart(),this.drawGame(),this.drawEnd()}update(){this.bird.update()}};document.addEventListener("click",(function(t){w.updateGameState(t)})),function t(){w.draw(),w.update(),requestAnimationFrame(t)}()})();