(()=>{"use strict";var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{v3:()=>$,Zw:()=>tt,LS:()=>Q,z4:()=>et});class e{constructor(t){this.audio=new Audio(t)}play(){this.audio.volume=e.volume,this.audio.play()}isPlaying(){return!this.audio.paused&&!this.audio.ended}pause(){this.audio.pause()}stop(){this.audio.currentTime=0,this.audio.pause()}}e.volume=.2;class s{constructor(){this.canvas=document.createElement("canvas"),this.canvas.id="canvas"}static getInstance(){return s.instance||(s.instance=new s),s.instance}getCanvas(){return this.canvas}getCtx(){return this.ctx}getW(){return this.canvas.width}getH(){return this.canvas.height}start(t,e){return this.canvas.width=t,this.canvas.height=e,document.body.insertBefore(this.canvas,document.body.childNodes[1]),this.canvas}}const i={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},n={LEFT:0,MIDDLE:1,RIGHT:2};class r{constructor(){this.keyCode=i,this.mouseCode=n,this.keyBindings={keyDown:{},keyUp:{},keyPress:{}},this.mouseBindings=""}static getInstance(){return r.instance||(r.instance=new r),r.instance}start(){document.addEventListener("keydown",(t=>this.handleKeyDown(t))),document.addEventListener("keyup",(t=>this.handleKeyUp(t))),document.addEventListener("click",(t=>this.handleClick(t))),document.addEventListener("mousemove",(t=>this.handleMouseMove(t)))}handleKeyDown(t){this.keyCode[t.key]||(this.keyBindings.keyDown[t.key]=1,this.keyBindings.keyPress[t.key]=1),delete this.keyBindings.keyUp[t.key]}handleKeyUp(t){this.keyBindings.keyUp[t.key]=1,delete this.keyBindings.keyPress[t.key]}handleClick(t){t.button===this.mouseCode.LEFT?this.mouseBindings="LEFT":t.button===this.mouseCode.MIDDLE?this.mouseBindings="MIDDLE":t.button===this.mouseCode.RIGHT&&(this.mouseBindings="RIGHT")}handleMouseMove(t){const e=p.canvas.getCanvas().getBoundingClientRect(),s=t.clientX-e.x,i=t.clientY-e.y;this.mousePosition=[s,i]}getMousePosition(){return this.mousePosition}hasKeyDown(t){return 1==this.keyBindings.keyDown[t]}hasKeyUp(t){return 1==this.keyBindings.keyDown[t]}hasKeyPress(t){return 1==this.keyBindings.keyDown[t]}hasMouseBinding(t){return this.mouseBindings===t}removeMouseBinding(){this.mouseBindings=""}}class a{constructor(){}}class h extends a{constructor(t,e,s,i,n,r=!0){super(),this.ctx=t,this.x=e,this.y=s,this.radius=i,this.color=n,r&&this.draw()}draw(){const t=new Path2D;t.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),this.ctx.fillStyle=this.color,this.ctx.fill(t),this.ctx.lineWidth=10,this.ctx.strokeStyle=this.color,this.ctx.stroke(t)}}class c{constructor(t,e,s,i,n,r,a,h=!0){this.ctx=t,this.x=s,this.y=i,this.image=e,this.width=n,this.height=r,this.direction=a,h&&this.draw()}draw(){-1==this.direction?this.drawMirrorImage(this.ctx,this.image,this.x,this.y,this.width,this.height):this.drawImage(this.ctx,this.image,this.x,this.y,this.width,this.height)}drawImage(t,e,s,i,n,r){n&&r?t.drawImage(e,s,i,n,r):t.drawImage(e,s,i)}drawMirrorImage(t,e,s,i,n,r){t.save(),t.translate(s,i),t.scale(-1,1),n&&r?t.drawImage(e,0,0,n,r,-45,0,n,r):t.drawImage(e,s,i),t.restore()}}class o extends a{constructor(t,e,s,i,n,r=!0,a="white"){super(),this.ctx=t,this.x=e,this.y=s,this.color=a,this.width=i,this.height=n,r&&this.draw()}getX(){return this.x}getY(){return this.y}getH(){return this.height}getW(){return this.width}draw(){this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y,this.width,this.height)}static isPointInRect(t,e,s,i,n,r){return Math.abs(t-s)<=n&&Math.abs(e-i)<=r}}class g{constructor(t,e,s,i,n,r=70){this.ctx=t,this.text=e,this.x=s,this.y=i,this.size=r,this.color=n,this.draw()}draw(){this.ctx.fillStyle=this.color,this.size?this.ctx.font="bold "+this.size+"px Arial":this.ctx.font="bold 70px Arial",this.text.length<2?this.ctx.fillText(this.text,this.x,this.y):this.text.length<3?this.ctx.fillText(this.text,this.x-20,this.y):this.ctx.fillText(this.text,this.x-40,this.y)}}class d{constructor(t){this.canvas=t,this.depth=[],this.ctx=t.getContext("2d")}static getInstance(t){return d.instance||(d.instance=new d(t)),d.instance}setDepth(t){this.depth.push(t)}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}draw(){this.depth[0].draw(),this.depth.pop()}drawRect(t,e,s,i,n){new o(this.ctx,t,e,s,i,!0,n)}drawCircle(t,e,s,i){new h(this.ctx,t,e,s,i)}drawText(t,e,s,i,n=70){new g(this.ctx,t,e,s,i,n)}drawImage(t,e,s,i,n){new c(this.ctx,t,e,s,i,n,1)}drawMirrorLRImage(t,e,s,i,n){new c(this.ctx,t,e,s,i,n,-1)}}class u{constructor(){}static getInstance(){return u.instance||(u.instance=new u),u.instance}getCurrentScene(){return this.currentScene}loadScene(t){this.currentScene&&this.currentScene.unload(),this.currentScene=t,this.currentScene.load(),p.renderer.setDepth(this.currentScene),p.renderer.draw()}}class l{constructor(){this.components=[],this.state=2,this.canvas=s.getInstance(),this.inputManager=r.getInstance(),this.sceneManager=u.getInstance(),this.renderer=d.getInstance(this.canvas.getCanvas())}start(t,e,s){this.canvas.start(t,e),this.inputManager.start(),this.sceneManager.loadScene(s),requestAnimationFrame((()=>this.update(Date.now())))}draw(){this.clearCanvas(this.canvas.getCanvas());for(const t of this.components)t.getIsEnabled()&&t.render()}update(t){switch(this.state){case 0:for(const e of this.components)e.getIsEnabled()&&e.update(t);break;case 1:for(const e of this.components)e.getIsEnabled()&&e.pause(t)}this.draw()}clearCanvas(t){t.getContext("2d").clearRect(0,0,t.width,t.height)}addComponent(t){this.components.push(t)}pause(){this.state=1}over(){this.state=3}resume(){this.state=0}}const p=new l;class w{constructor(t){this.canvas=t,this.depths=new Map,this.context=t.getContext("2d")}addObject(t,e){this.depths.set(t,e),this.sortObjects()}sortObjects(){this.depths=new Map(Array.from(this.depths.entries()).sort(((t,e)=>t[1]-e[1])))}getObjects(){return this.depths}}class m{constructor(t,e){this.x=t,this.y=e}getX(){return this.x}getY(){return this.y}setX(t){this.x=t}setY(t){this.y=t}static add(t,e){return new m(t.x+e.x,t.y+e.y)}static sub(t,e){return new m(t.x-e.x,t.y-e.y)}static mul(t,e){return new m(t.x*e,t.y*e)}static distance(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}}s.getInstance().start(360,480).getContext("2d");class y{constructor(){this.isEnabled=!0,this.isActive=!0,this.game=p,this.canvas=p.canvas.getCanvas()}getIsEnabled(){return this.isEnabled}setToggleActive(t){t&&!this.isEnabled?this.isEnabled=!0:!t&&this.isEnabled&&(this.isEnabled=!1)}reset(){}}class b extends y{constructor(t=new m(0,0)){super(),this.components=[],this.position=t,this.game=p}getW(){return this.w}getH(){return this.h}setW(t){this.w=t}setH(t){this.h=t}getX(){return this.getPosition().getX()}getY(){return this.getPosition().getY()}setX(t){this.setPosition(new m(t,this.getY()))}setY(t){this.setPosition(new m(this.getX(),t))}setToggleActive(t){if(t&&!this.isEnabled){for(const t in this.components)this.components[t].setToggleActive(!0);this.isEnabled=!0}else if(!t&&this.isEnabled){for(const t in this.components)this.components[t].setToggleActive(!0);this.isEnabled=!1}}setPosition(t){this.position=t}getPosition(){return this.position}addComponent(t){this.components.push(t)}onCollision(t){throw new Error("Method not implemented.")}}class S extends y{constructor(t){super(),this.game.addComponent(this),this.gameObject=t,this.gameObject.addComponent(this)}getName(){return this.name}setName(t){this.name=t}}class x extends S{constructor(t){super(t)}setSpriteImg(t){this.image=t}getSpriteImg(){return this.image}render(){this.gameObject.getIsEnabled()&&this.gameObject.render()}update(t){}pause(t){}}const k=new Image;k.src="assets/images/background.png";class v extends b{constructor(t){super(t),this.setW(320),this.setH(480),this.setX(180),this.setY(235),this.sprite=new x(this),this.sprite.setSpriteImg(k)}render(){this.game.renderer.drawImage(k,this.getX()-this.getW()/2,this.getY()-this.getH()/2,this.getW(),this.getH())}update(t){}pause(){}}const I=new Image;I.src="assets/images/spikes_small_up.png";class C extends b{constructor(t){super(t),this.setW(1080/3.3-7),this.setH(218/3.3),this.setX(20),this.setY(425),this.sprite=new x(this),this.sprite.setSpriteImg(I)}render(){p.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH())}update(t,e){}pause(){}onCollision(t){}}const f=new Image;f.src="assets/images/spikes_small.png";class M extends b{constructor(t){super(t),this.setW(1080/3.3-7),this.setH(218/3.3),this.setX(20),this.setY(0),this.sprite=new x(this),this.sprite.setSpriteImg(f)}render(){p.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH())}update(t,e){}pause(){}onCollision(t){}}(new Image).src="assets/images/background.png";const X=new Image;X.src="assets/images/points.png";const E=new Image;E.src="assets/images/dttsString.png";const P=new Image;P.src="assets/images/StringBEST.png";const Y=new Image;Y.src="assets/images/HitString.png";class O extends b{constructor(t){super(t),this.bestScore=0,this.gamesPlayed=0,this.candyCount=0,this.score=0,this.setX(180),this.setY(240),this.sprite=new x(this)}drawStartScore(){const t=this.game.renderer;t.drawImage(E,45,75,873/3.2,75),t.drawImage(Y,125,170,111,57),t.drawImage(P,70,327,191.875,48.4375),t.drawText(J.getScore().bestScore.toString(),287,350,"#aaa",30),t.drawText(J.getScore().gamesPlayed.toString(),287,377,"#aaa",30)}drawEndScore(){const t=this.game.renderer;t.drawImage(E,45,75,873/3.2,75),t.drawImage(X,45,180,230/.85,150);const e=J.getScore().score+3*this.candyCount;e<10?t.drawText(J.getScore().score.toString(),163,235,"white",50):e>=10&&e<100?t.drawText(J.getScore().score.toString(),170,235,"white",50):e>=100&&t.drawText(J.getScore().score.toString(),163,235,"white",50),t.drawImage(P,74,350,191.875,48.4375),t.drawText(J.getScore().bestScore.toString(),287,370,"#aaa",30),t.drawText(J.getScore().gamesPlayed.toString(),287,397,"#aaa",30)}drawGameScore(){const t=this.game.renderer;t.drawCircle(this.getX(),this.getY(),65,"white"),this.score<10||this.score<100?t.drawText(this.score.toString(),160,268,"#ababab"):this.score>=100&&t.drawText(this.score.toString(),150,268,"#ababab")}render(){2===this.game.state?this.drawStartScore():0===this.game.state?this.drawGameScore():this.drawEndScore()}update(t,e){}pause(){}increaseScore(){this.score+=1}getScore(){return this.score}updateCandy(){this.candyCount++}getCandy(){return this.candyCount}getBestScore(){return this.bestScore}getGamesPlayed(){return this.gamesPlayed}}class j extends w{constructor(t){super(t)}getScore(){return this.score}load(){this.background=new v(new m(0,0)),this.score=new O(new m(0,0)),this.topSpikes=new M(new m(0,0)),this.botSpikes=new C(new m(0,0)),this.addObject(this.background,0),this.addObject(this.score,1),this.addObject(this.topSpikes,2),this.addObject(this.botSpikes,3)}draw(){this.update();for(const[t,e]of this.depths)t.render()}update(){if(p.inputManager.hasMouseBinding("LEFT")){const[t,e]=p.inputManager.getMousePosition();o.isPointInRect(t,e,50,277,262,53)&&(p.state=2)}p.inputManager.removeMouseBinding()}unload(){p.renderer.clear()}}class T extends S{constructor(t,e=new m(0,0)){super(t),this.gravity=.2,this.force=new m(0,0),this.velocity=e}update(t){this.velocity=m.add(this.velocity,m.mul(new m(this.force.getX(),this.force.getY()+this.gravity),t/16)),this.gameObject.setPosition(m.add(this.gameObject.getPosition(),m.mul(this.velocity,t/16)))}getVelocity(){return this.velocity}getVelocityX(){return this.velocity.getX()}getVelocityY(){return this.velocity.getY()}setVelocity(t){this.velocity=t}render(){}pause(){this.gravity=0,this.velocity=new m(0,0)}}class D extends S{constructor(t){super(t),this.freq=980,this.amplitude=.5,this.phase=0,this.velocity=new m(0,this.amplitude)}update(t){this.phase+=2*Math.PI*this.freq*t/16,this.velocity.setY(this.amplitude*Math.sin(this.phase)*t/16),this.gameObject.setPosition(m.add(this.gameObject.getPosition(),m.mul(this.velocity,t/16)))}reset(){this.freq=980,this.amplitude=.5,this.phase=0,this.velocity=new m(0,this.amplitude)}render(){}pause(){}}class H extends a{constructor(t,e,s,i=!0){super(),this.ctx=t,this.points=e,this.color=s,i&&this.draw()}getPoints(){return this.points}draw(){const[t,e,s]=this.points;this.ctx.beginPath(),this.ctx.moveTo(t.getX(),t.getY()),this.ctx.lineTo(e.getX(),e.getY()),this.ctx.lineTo(s.getX(),s.getY()),this.ctx.closePath(),this.ctx.fillStyle=this.color,this.ctx.stroke()}}class B extends S{constructor(t){super(t),this.checkHitRectangle=t=>{const[e,s]=[this.gameObject.getX(),this.gameObject.getY()],[i,n,r,a]=[t.getX(),t.getY(),t.getW(),t.getH()];return Math.abs(i-e)<=r&&Math.abs(n-s)<=a},this.checkHitTriangle=t=>{const[e,s,i,n]=[this.gameObject.getX(),this.gameObject.getY(),this.gameObject.getW(),this.gameObject.getH()],r=[new m(e+i,s),new m(e+i,s+n),new m(e+i,(s+s+n)/2),new m(e,s),new m(e,s+n),new m(e,(s+s+n)/2)];for(const e of r)if(this.checkHitTriangleUtils(e,t))return!0;return!1},this.checkHitTriangleUtils=(t,e)=>{const[s,i,n]=e.getPoints(),r=(i.getY()-n.getY())*(s.getX()-n.getX())+(n.getX()-i.getX())*(s.getY()-n.getY()),a=((i.getY()-n.getY())*(t.getX()-n.getX())+(n.getX()-i.getX())*(t.getY()-n.getY()))/r,h=((n.getY()-s.getY())*(t.getX()-n.getX())+(s.getX()-n.getX())*(t.getY()-n.getY()))/r;return a>=0&&h>=0&&1-a-h>=0}}render(){}update(){}pause(){}checkCollision(t){if(t.object instanceof o)return this.checkHitRectangle(t.object);if(t.object instanceof H)return this.checkHitTriangle(t.object);throw new Error("Not Implemented")}}class A extends B{constructor(t){super(t),this.checkOutOfBounds=()=>this.gameObject.getY()<Math.floor(this.gameObject.getH())+40||this.gameObject.getY()>480-Math.floor(this.gameObject.getH())-70,this.checkHitSpike=(t,e)=>{const[s,i]=[69/3.2,36.25];let n,r,a;if(2==t){n=new m(357-s,e),r=new m(357-2*s,e+i/2),a=new m(357-s,e+i);const t=new H(J.game.canvas.getCtx(),[n,r,a],"white",!1);if(this.checkCollision({object:t}))return!0}else{n=new m(0+s,e),r=new m(0+s,e+i),a=new m(0+2*s,e+i/2);const t=new H(J.game.canvas.getCtx(),[n,r,a],"white",!1);if(this.checkCollision({object:t}))return!0}return!1},this.checkHitCandy=()=>{const t=J.game.sceneManager.getCurrentScene().getCandy(),e=new o(J.game.canvas.getCtx(),t.getX(),t.getY(),t.getW(),t.getH(),!1);return!!this.checkCollision({object:e})},this.collider=new B(t)}checkWallCollision(t){return 2==t&&Math.floor(this.gameObject.getX())>=360-Math.floor(this.gameObject.getW())-20||1==t&&Math.floor(this.gameObject.getX())<=20}}class W{constructor(){this.subscribers=new Set}subscribe(t){this.subscribers.add(t)}unsubscribe(t){this.subscribers.delete(t)}notify(t){for(const e of this.subscribers)e.onCollision(t)}}const R=new Image;R.src="assets/images/bird1_small.png";const L=new Image;L.src="assets/images/bird2_small.png",(new Image).src="assets/images/bird_food.png";const U=new Image;U.src="assets/images/bird_dead.png";class _ extends b{constructor(t,e){super(e),this.checkCandyCollided=!1,this.flap=t=>{Q.play(),this.sprite.setSpriteImg(R),this.physics.setVelocity(new m(this.physics.getVelocityX(),-t))},this.setW(48.75),this.setH(31.5625),this.setX(160),this.setY(240),this.eventSystem=new W,this.name=t,this.direction=2,this.sprite=new x(this),this.sprite.setSpriteImg(L),this.oscillator=new D(this),this.physics=new T(this,new m(2.5,0)),this.collider=new A(this)}subscribeCollision(){const t=J.game.sceneManager.getCurrentScene();this.eventSystem.subscribe(t.getBird()),this.eventSystem.subscribe(t.getCandy());for(const e of t.getSpikes())this.eventSystem.subscribe(e)}update(){return t=this,e=void 0,i=function*(){const t=J.game.sceneManager.getCurrentScene();this.collider.checkOutOfBounds()&&this.eventSystem.notify(2),this.collider.checkHitCandy()&&t.getCandy().getIsEnabled()&&(this.eventSystem.notify(3),this.sprite.setSpriteImg(U));for(const e of t.getSpikes())this.collider.checkHitSpike(this.direction,e.getY())&&(this.sprite.setSpriteImg(U),tt.play(),yield new Promise((t=>{setTimeout(t,500),this.physics.pause()})),this.eventSystem.notify(1))},new((s=void 0)||(s=Promise))((function(n,r){function a(t){try{c(i.next(t))}catch(t){r(t)}}function h(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(a,h)}c((i=i.apply(t,e||[])).next())}));var t,e,s,i}render(){J.game.sceneManager.getCurrentScene()instanceof q&&this.update(),2==this.direction?J.game.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH()):J.game.renderer.drawMirrorLRImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH()),this.checkChangeDirection(),this.sprite.setSpriteImg(L)}checkChangeDirection(){2==this.direction?this.collider.checkWallCollision(this.direction)&&(this.direction=1,this.eventSystem.notify(0)):1==this.direction&&this.collider.checkWallCollision(this.direction)&&(this.direction=2,this.eventSystem.notify(0))}enableCandy(){const t=J.game.sceneManager.getCurrentScene();t.getCandy().getIsEnabled()||t.getCandy().setToggleActive(!0)}changeDirection(){this.physics.setVelocity(m.mul(this.physics.getVelocity(),-1)),this.physics.setVelocity(new m(this.physics.getVelocityX(),-1))}onCollision(t){2==t?(tt.play(),J.game.over()):0==t&&(et.play(),this.changeDirection(),J.updateWallCollision(),this.enableCandy())}}const N=new Image;N.src="assets/images/candy.png";class V extends b{constructor(t){super(t),this.setW(36.875),this.setH(21.875),this.setX(70),this.setY(-70),this.sprite=new x(this),this.sprite.setSpriteImg(N),this.oscillator=new D(this)}render(){this.getIsEnabled()&&p.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH())}update(t){this.setY(t.getY()-20),t.getX()>300?this.setX(t.getX()-40):this.setX(t.getX()+45)}pause(){}onCollision(t){if(3==t){const t=J.game.sceneManager.getCurrentScene();$.play(),t.getScore().updateCandy(),t.getCandy().setToggleActive(!1)}}}const G=new Image;G.src="assets/images/spike_small.png";class F extends b{constructor(t){super(t),this.setW(69/3.2),this.setH(36.25),this.setX(318),this.setY(-70),this.physics=new D(this),this.sprite=new x(this),this.sprite.setSpriteImg(G)}render(){this.getX()>300?p.renderer.drawImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH()):p.renderer.drawMirrorLRImage(this.sprite.getSpriteImg(),this.getX(),this.getY(),this.getW(),this.getH())}update(t){this.physics.reset()}pause(){}onCollision(t){1==t&&J.game.over()}}class K extends b{constructor(){super(),this.reset=()=>{this.length=3,this.spikes=[];for(let t=0;t<this.length;t++)this.spikes.push(new F(new m(0,0)))},this.length=3,this.spikes=[];for(let t=0;t<this.length;t++)this.spikes.push(new F(new m(0,0)));this.sprite=new x(this)}genRandom(){let t=0,e=0;for(;0===t;)t=Math.random();for(;0===e;)e=Math.random();let s=Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*e);return s=s/10+.5,s>1||s<0?this.genRandom():s}getSpikes(){return this.spikes}render(){for(let t=0;t<this.length;t++)this.spikes[t].render()}update(){if(J.getScore().score>0&&J.getScore().score%5==0){this.spikes.push(new F(new m(0,0))),this.length++;for(let t=0;t<this.length;t++)this.spikes[t].update(0)}const t=290/this.length;for(let e=0;e<this.length;e++){const s=Math.floor(this.genRandom()*t+80+t*e);s>=90&&s<380&&(this.spikes[e].setY(s),this.spikes[e].getX()>300?this.spikes[e].setX(-3):this.spikes[e].setX(318))}}}class q extends w{constructor(t){super(t)}getScore(){return this.score}load(){this.background=new v(new m(0,0)),this.score=new O(new m(0,0)),this.bird=new _("Game",new m(0,0)),this.topSpikes=new M(new m(0,0)),this.botSpikes=new C(new m(0,0)),this.sideSpikes=new K,this.candy=new V(new m(0,0)),this.addObject(this.background,0),this.addObject(this.score,1),this.addObject(this.bird,2),this.addObject(this.topSpikes,3),this.addObject(this.botSpikes,4),this.addObject(this.sideSpikes,5),this.addObject(this.candy,6),this.bird.subscribeCollision()}getBird(){return this.bird}getCandy(){return this.candy}getSpikes(){return this.sideSpikes.getSpikes()}draw(){this.update();for(const[t,e]of this.depths)t.render()}update(){p.inputManager.hasMouseBinding("LEFT")&&this.bird.flap(3.5),p.inputManager.removeMouseBinding()}unload(){J.getScore().score=this.getScore().getScore()+3*this.getScore().getCandy(),J.getScore().bestScore=Math.max(J.getScore().bestScore,J.getScore().score),J.getScore().gamesPlayed++,this.bird.setToggleActive(!1),p.renderer.clear()}updateScore(){this.getScore().increaseScore(),J.getScore().score=this.getScore().getScore(),this.sideSpikes.update(),this.candy.update(this.sideSpikes.getSpikes().slice(-1)[0])}}class z extends w{constructor(t){super(t)}getScore(){return this.score}load(){this.background=new v(new m(0,0)),this.score=new O(new m(0,0)),this.bird=new _("Ready",new m(0,0)),this.topSpikes=new M(new m(0,0)),this.botSpikes=new C(new m(0,0)),this.addObject(this.background,0),this.addObject(this.score,1),this.addObject(this.bird,2),this.addObject(this.topSpikes,3),this.addObject(this.botSpikes,4)}draw(){this.update();for(const[t,e]of this.depths)t.render()}update(){p.inputManager.hasMouseBinding("LEFT")&&(p.state=0),p.inputManager.removeMouseBinding()}unload(){this.bird.setToggleActive(!1),p.renderer.clear()}}class Z extends l{constructor(){super(),this.game=p,this.score={score:0,bestScore:0,gamesPlayed:0},this.curState=2}getScore(){return this.score}updateWallCollision(){p.sceneManager.getCurrentScene().updateScore()}start(){p.start(360,480,new z(p.canvas.getCanvas())),this.update(Date.now())}draw(){if(this.curState!=p.state)switch(this.curState=p.state,p.state){case 2:p.sceneManager.loadScene(new z(p.canvas.getCanvas()));break;case 0:p.sceneManager.loadScene(new q(p.canvas.getCanvas()));break;case 3:p.sceneManager.loadScene(new j(p.canvas.getCanvas()))}p.sceneManager.getCurrentScene().draw(),p.draw()}update(t){const e=Date.now();p.update(e-t),this.draw(),t=Date.now(),requestAnimationFrame((()=>this.update(t)))}}const J=new Z,Q=new e("assets/sounds/jump.ogg"),$=new e("assets/sounds/candy.mp3"),tt=new e("assets/sounds/death.ogg"),et=new e("assets/sounds/point.ogg");new e("assets/sounds/music.mp3"),(new Z).start()})();